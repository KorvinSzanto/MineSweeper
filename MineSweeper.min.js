function mineSweeper(a,b,c){function g(a){var b=h(a)[0],c=h(a)[1];if(j(b,c)===!1){--c,--b;var d=0;for(mody=0;mody<3;mody++)for(modx=0;modx<3;modx++){var e=b+modx,f=c+mody;j(e,f)&&++d}return d}return"0"}function h(a){if(typeof a=="object"){var b=a.attr("id").split(" ")[0].split("y"),c=[];return c[0]=b[0].split("x")[1],c[1]=b[1],c}}function i(a,b){return l(a,b).hasClass("mine")}function j(a,b){return l(a,b).hasClass("flagged")}function k(a){if(a.attr("title")!="n")return a.attr("title");var b=h(a)[0],c=h(a)[1];if(i(b,c)===!1){--c,--b;var d=0;for(mody=0;mody<3;mody++)for(modx=0;modx<3;modx++){var e=b+modx,f=c+mody;i(e,f)&&++d}return d}return"x"}function l(a,b){return $("#x"+a+"y"+b)}function m(a,b,c,d,e){while($(".mine").length<c){var f=Math.round(Math.random()*a),g=Math.round(Math.random()*b);l(f,g).hasClass("mine")==0&&f+","+g!=d+","+e&&l(f,g).addClass("mine")}}function n(a){if(!a.hasClass("hide"))return;a.removeClass("hide").removeClass("flagged");var b=h(a)[0],c=h(a)[1];i(b,c)&&r();if(k(a)=="0"){a.children("div").text(""),--c,--b;var d=0,e,f;for(e=0;e<3;e++)for(f=0;f<3;f++){var g=b+f,j=c+e;n(l(g,j))}}}function o(a){var b=h(a)[0],c=h(a)[1];--c,--b;var d=0,e,f;for(e=0;e<3;e++)for(f=0;f<3;f++){var g=b+f,i=c+e;j(g,i)||n(l(g,i))}}function p(){var a=$(".flagged",".block").length,b=$(".mine",".block").length,c=$(".hide",".block").length,d=$(".flagged.mine",".block").length;d==b&&a==b&&($(".flags",".minefield").text(b),q()),c==b&&($(".flags",".minefield").text(b),q()),$(".flags",".minefield").text(a),$(".mines",".minefield").text(b)}function q(){window.clearInterval(timer),$(".smiley",".minefield").txt("8)"),$(".mine",".block").addClass("flagged"),$(".block",".minefield").removeClass("hide"),$(".flags",".minefield").text($(".mines",".minefield").text())}function r(){window.clearInterval(timer),$(".block",".minefield").removeClass("hide"),$(".smiley",".minefield").text(":'(")}b=b<9?9:b,a=a<9?9:a,c=c>a*b-1?a*b-1:c;var d="<tr><td class='score' colspan="+a+"><span class='info'><span class='flags'>0</span><span class='smiley'>:|</span><span class='mines'>"+c+"</span></span></td></tr><tr><td colspan="+a+" class=time>00:00:00</td></tr>";for(var e=0;++e<=b;){d+="<tr>";for(var f=0;++f<=a;)d+="<td id='x"+f+"y"+e+"' class='block hide' title='n'><div></div></td>";d+="</tr>"}$(".minefield").css({width:(a+2)*20,height:(b+2)*20}).append(d).attr("cellpadding",0).attr("cellspacing",0),$(".block",".minefield").bind("contextmenu",function(a){a.preventDefault()}),$(".block",".minefield").mouseup(function(d){$(".smiley",".minefield").text(":)");switch(d.which){case 1:var e=h($(this));$(".mine",".block").length==0&&(time=Math.round((new Date).getTime()/1e3),timer=window.setInterval(function(){var a=Math.round((new Date).getTime()/1e3);seconds=a-time,hours=Math.floor(seconds/3600),seconds%=3600,minutes=Math.floor(seconds/60),seconds%=60,$(".time",".minefield").text((hours<10?"0"+hours:hours)+":"+(minutes<10?"0"+minutes:minutes)+":"+(seconds<10?"0"+seconds:seconds))},1e3),m(a,b,c,e[0],e[1]),$.each($(".block",".minefield"),function(){num=k($(this)),$(this).attr("title",num).children("div").text(num==0?"":num)})),$(this).hasClass("hide")&&n($(this));break;case 3:return d.preventDefault(),$(this).hasClass("flagged")?$(this).removeClass("flagged"):$(this).hasClass("hide")&&$(this).addClass("flagged"),p(),!1}p()}).mousedown(function(a){$(".smiley",".minefield").text(":O")}),$(".block",".minefield").dblclick(function(){k($(this))<=g($(this))&&o($(this)),p()}),$("div",".block").dblclick(function(){k($(this).parent())<=g($(this).parent())&&o($(this).parent()),p()})}